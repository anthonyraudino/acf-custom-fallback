<?php
/*
Plugin Name: ACF Field Fallback
Plugin URI: https://madewithhearts.com.au/
Description: Displays an advanced custom field using a shortcode with fallback value using [acf_field_fallback field_name="my_custom_field" fallback="N/A"]
Version: 0.9.5
Author: Anthony Raudino
Author URI: https://madewithhearts.com.au/
License: GPL2
*/

// Add shortcode
function acf_field_fallback_shortcode( $atts ) {
    $atts = shortcode_atts( array(
        'field_name' => '',
        'post_id' => get_queried_object_id(),
        'fallback' => 'N/A',
        'prefix' => '',
        'suffix' => '',
    ), $atts, 'acf_field_fallback' );

    if ( empty( $atts['field_name'] ) ) {
        return '';
    }

    $field_value = get_field( $atts['field_name'], $atts['post_id'], false );

    if ( empty( $field_value ) ) {
        $field_value = $atts['fallback'];
    }

    if ( $field_value === $atts['fallback'] ) {
        // Field value is fallback, do not display prefix and suffix
        $output = $field_value;
    } else {
        // Field value is not fallback, display prefix, suffix, and capitalize the text
        $output = $atts['prefix'] . " " . ucfirst( $field_value ) . " " . $atts['suffix'];
    }

    return $output;
}
add_shortcode( 'acf_field_fallback', 'acf_field_fallback_shortcode' );
